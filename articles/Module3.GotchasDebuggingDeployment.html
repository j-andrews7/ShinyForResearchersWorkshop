<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Module 3 - Common Gotchas, Debugging Shiny, and App Deployment • ShinyForScientistsWorkshop</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Module 3 - Common Gotchas, Debugging Shiny, and App Deployment">
<meta property="og:description" content="ShinyForScientistsWorkshop">
<meta property="og:image" content="https://j-andrews7.github.io/ShinyForScientistsWorkshop/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ShinyForScientistsWorkshop</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Module1.ShinyConcepts.html">Module 1 - Basic Shiny Concepts</a>
    </li>
    <li>
      <a href="../articles/Module2.ShinyAppDevelopment.html">Module 2 - Shiny App Development</a>
    </li>
    <li>
      <a href="../articles/Module3.GotchasDebuggingDeployment.html">Module 3 - Common Gotchas, Debugging Shiny, and App Deployment</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/j-andrews7/ShinyForScientistsWorkshop" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Module 3 - Common Gotchas, Debugging Shiny, and
App Deployment</h1>
                        <h4 data-toc-skip class="author">Jared
Andrews</h4>
            <address class="author_afil">
      St. Jude Children’s Research Hospital, Memphis,
TN<br><a class="author_email" href="mailto:#"></a><a href="mailto:jared.andrews@stjude.org" class="email">jared.andrews@stjude.org</a>
      </address>
                  
            <h4 data-toc-skip class="date">May 12th, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/j-andrews7/ShinyForScientistsWorkshop/blob/HEAD/vignettes/Module3.GotchasDebuggingDeployment.Rmd" class="external-link"><code>vignettes/Module3.GotchasDebuggingDeployment.Rmd</code></a></small>
      <div class="hidden name"><code>Module3.GotchasDebuggingDeployment.Rmd</code></div>

    </div>

    
    
<style type="text/css">
// This is a CSS code chunk to make the page wider, as the default width is annoyingly narrow.
body {
  max-width: 1400px !important;
}
div.main-container {
  max-width: 1400px !important;
  width: 1400px !important;
  margin-left: auto !important;
  margin-right: auto !important;
}
.toc-content {
  padding-right: 0px;
  padding-left: 0px;
  margin-left: 300px;
  max-width: 1100px !important;
  width: 1100px !important;
}
</style>
<p><strong>St. Jude members may view <a href="https://svlpbakerlab01.stjude.org/ShinyWorkshopModule4/" class="external-link">an
interactive form of this document here</a>.</strong> Must be connected
to the St. Jude network to view.</p>
<div class="section level2">
<h2 id="section-common-gotchas-and-debugging-challenges">Common Gotchas and Debugging Challenges<a class="anchor" aria-label="anchor" href="#section-common-gotchas-and-debugging-challenges"></a>
</h2>
<p>Debugging, the process of finding and fixing bugs, is a critical
skill when working with Shiny apps, just like with any other
programming.</p>
<p>There are many “gotchas” that beginner Shiny developers can run into,
and these are typically more difficult to troubleshoot than typical R
code for a few reasons.</p>
<p>These debugging challenges stem from:</p>
<ul>
<li><p><strong>Reactivity:</strong> Shiny operates on a reactive
programming model, which can be quite different from the standard
procedural programming model common in R. In reactive programming,
outputs are automatically updated based on changes to inputs. This can
make it harder to reason about the order in which different parts of
your code are executed, especially for beginners.</p></li>
<li><p><strong>Asynchronous operations:</strong> Shiny apps often
involve asynchronous operations, such as user input or data loading.
These operations can occur at any time and in any order, which can make
bugs harder to reproduce and track down.</p></li>
<li><p><strong>Reactive context:</strong> Reactive expressions in Shiny
apps can only be evaluated in a reactive context. Trying to access
reactive values outside of this context can lead to errors. This
restriction can make it challenging to debug Shiny apps using
traditional methods, like print statements or the browser
console.</p></li>
<li><p><strong>Multiple environments:</strong> Shiny applications have
multiple environments (user-interface environment, server environment)
where the code runs. This can lead to issues if you’re not careful about
where variables are defined and accessed.</p></li>
<li><p><strong>Concurrency issues:</strong> Shiny apps can be accessed
by multiple users at the same time, and each user has their own session.
This can lead to concurrency issues, which can be very difficult to
debug. For example, a bug might only occur when two users interact with
the app in a certain way at the same time.</p></li>
<li><p><strong>Deployment-related issues:</strong> Problems may arise
when deploying Shiny apps that were not present during local
development. These can be due to differences in the environments, such
as different R versions available or missing system dependencies on the
host.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="section-debugging-shiny-apps">Debugging Shiny Apps<a class="anchor" aria-label="anchor" href="#section-debugging-shiny-apps"></a>
</h2>
<p>Here are a few techniques you can use to debug your Shiny apps:</p>
<ul>
<li>
<strong>The <code><a href="https://rdrr.io/r/base/browser.html" class="external-link">browser()</a></code> function:</strong> This function
pauses execution of your app and lets you interactively run and inspect
code. You can step through your code line by line and examine the
current state of variables and reactives.</li>
</ul>
<p>For example:</p>
<div class="sourceCode" id="section-cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.rstudio.com/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/titlePanel.html" class="external-link">titlePanel</a></span><span class="op">(</span><span class="st">"Debugging Shiny Apps"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html" class="external-link">sidebarLayout</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html" class="external-link">sidebarPanel</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/numericInput.html" class="external-link">numericInput</a></span><span class="op">(</span><span class="st">"num"</span>, <span class="st">"Enter a number"</span>, value <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html" class="external-link">mainPanel</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html" class="external-link">textOutput</a></span><span class="op">(</span><span class="st">"result"</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">output</span><span class="op">$</span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/browser.html" class="external-link">browser</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">num</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"The reciprocal is"</span>, <span class="va">x</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></span></code></pre></div>
<p>When the <code><a href="https://rdrr.io/r/base/browser.html" class="external-link">browser()</a></code> line is hit, you’ll be able to step
through the code and see the value of each variable at each step.</p>
<p>Consider this your bread and butter for debugging Shiny apps and R
code in general.</p>
<ul>
<li>
<strong>Using the react log:</strong> This method uses the
<code>reactlog</code> package to log reactive events in your app. This
can be very helpful to see when and why your reactive expressions are
firing.</li>
</ul>
<p>To see how it works, launch our simple app and change the input value
a few times.</p>
<div class="sourceCode" id="section-cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/reactlog/" class="external-link">reactlog</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/reactlog/reference/setReactLog.html" class="external-link">reactlog_enable</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># This turns on reactive logging for Shiny apps in the R session.</span></span>
<span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">output</span><span class="op">$</span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">num</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"The reciprocal is"</span>, <span class="va">x</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></span></code></pre></div>
<p>Now open the react log.</p>
<div class="sourceCode" id="section-cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactlog.html" class="external-link">reactlogShow</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This is useful when you’re unsure of when and why your reactives are
firing.</p>
<ul>
<li>
<strong>The <code><a href="https://rdrr.io/pkg/shiny/man/reactiveConsole.html" class="external-link">reactiveConsole()</a></code> function:</strong> This
one isn’t necessarily a debugging tool, but it’s useful for playing
around with reactives in the console. This function allows you to
interactively run code that involves reactive values or expressions.
Normally, you can’t do this because reactives only work within the
correct reactive context. But when you call
<code>reactiveConsole(TRUE)</code>, you can run this code directly from
the console.</li>
</ul>
<p><strong>This is an experimental feature currently, but it’s useful
for playing around with reactives in the console.</strong></p>
<p>For example:</p>
<div class="sourceCode" id="section-cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactiveConsole.html" class="external-link">reactiveConsole</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactiveVal.html" class="external-link">reactiveVal</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observe.html" class="external-link">observe</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"The value of x is "</span>, <span class="fu">x</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">x</span><span class="op">(</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu">x</span><span class="op">(</span><span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactiveConsole.html" class="external-link">reactiveConsole</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>This is useful when you want to experiment with reactives to see how
they interact.</p>
<p>Remember, debugging is a skill that takes practice to develop, and
these tools will help you identify and fix issues in your Shiny apps
more easily.</p>
<div class="section level3">
<h3 id="section-an-exercise-in-debugging">An Exercise in Debugging<a class="anchor" aria-label="anchor" href="#section-an-exercise-in-debugging"></a>
</h3>
<p>Here’s a common “gotcha” scenario involving reactivity and debugging
in R Shiny.</p>
<p>Consider the following simple Shiny app:</p>
<div class="sourceCode" id="section-cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.rstudio.com/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textInput.html" class="external-link">textInput</a></span><span class="op">(</span><span class="st">"inputText"</span>, <span class="st">"Enter some text:"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html" class="external-link">actionButton</a></span><span class="op">(</span><span class="st">"goButton"</span>, <span class="st">"Go"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html" class="external-link">textOutput</a></span><span class="op">(</span><span class="st">"outputText"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">goButton</span>, <span class="op">{</span></span>
<span>        <span class="va">output</span><span class="op">$</span><span class="va">outputText</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"You entered:"</span>, <span class="va">input</span><span class="op">$</span><span class="va">inputText</span><span class="op">)</span></span>
<span>        <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span>ui <span class="op">=</span> <span class="va">ui</span>, server <span class="op">=</span> <span class="va">server</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>In this app, the user is supposed to enter some text, then click the
“Go” button to display the entered text. However, when you run this app
and try to use it, you’ll find that the “Go” button doesn’t seem to do
anything beyond the first press. The output text doesn’t update when you
click the button, but when you input the number.</p>
<p>Take a close look at the code. Have any ideas about what’s going
on?</p>
<div class="section level4">
<h4 id="section-using-browser-to-debug">Using <code>browser()</code> to Debug<a class="anchor" aria-label="anchor" href="#section-using-browser-to-debug"></a>
</h4>
<p>Let’s try using our newfound friend, the <code>browser</code>
function, to see if we can figure out what’s going on.</p>
<p>First, we have to add the <code><a href="https://rdrr.io/r/base/browser.html" class="external-link">browser()</a></code> function to our
code. Execution will pause at whatever point we place it, and we’ll be
able to explore the environment or step through the code line by
line.</p>
<p>Take a second to think about where it makes the most sense to place
the <code><a href="https://rdrr.io/r/base/browser.html" class="external-link">browser()</a></code> function in this app.</p>
<p>You can use as many browser calls as you’d like - execution will
pause at each, but usually you’ll only need one or two near where the
problem is occurring.</p>
<div class="sourceCode" id="section-cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textInput.html" class="external-link">textInput</a></span><span class="op">(</span><span class="st">"inputText"</span>, <span class="st">"Enter some text:"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html" class="external-link">actionButton</a></span><span class="op">(</span><span class="st">"goButton"</span>, <span class="st">"Go"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html" class="external-link">textOutput</a></span><span class="op">(</span><span class="st">"outputText"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">goButton</span>, <span class="op">{</span></span>
<span>        <span class="va">output</span><span class="op">$</span><span class="va">outputText</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/browser.html" class="external-link">browser</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Add browser() call here</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"You entered:"</span>, <span class="va">input</span><span class="op">$</span><span class="va">inputText</span><span class="op">)</span></span>
<span>        <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span>ui <span class="op">=</span> <span class="va">ui</span>, server <span class="op">=</span> <span class="va">server</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>When you run this app, enter some text, and click the “Go” button,
the app will pause and you’ll be put into browser mode. You can now
inspect the environment at this point in the execution. For example, you
could check the value of <code>input$inputText</code>.</p>
<p>Click “Continue” to resume execution, then change the input values.
This will result in <code>browser</code> being called again.</p>
<p>In this case, the <code><a href="https://rdrr.io/r/base/browser.html" class="external-link">browser()</a></code> function can help you
understand that <code>renderText</code> is being recomputed even when
the button isn’t pressed. In general, <code><a href="https://rdrr.io/r/base/browser.html" class="external-link">browser()</a></code> is a great
tool for understanding the flow of a Shiny app and figuring out where
things are going wrong. It’s especially useful in more complex apps
where the control flow and reactivity can be difficult to follow.</p>
</div>
<div class="section level4">
<h4 id="section-the-issue">The Issue<a class="anchor" aria-label="anchor" href="#section-the-issue"></a>
</h4>
<p>The mistake here is a misunderstanding about how reactivity works in
Shiny.</p>
<p><code>observeEvent</code> depends on <code>input$goButton</code>, but
the expression passed to it is not isolated.</p>
<p>That means that if it uses or depends on reactive values, it will be
re-executed whenever those values change, regardless of whether the
event has occurred. The <code>renderText</code> function includes
<code>input$inputText</code>, which is a reactive value, so
<code>renderText</code> will be re-executed whenever the value of
<code>input$inputText</code> changes.</p>
<p>There are a few ways to fix this:</p>
<ol style="list-style-type: decimal">
<li>Use <code><a href="https://rdrr.io/pkg/shiny/man/isolate.html" class="external-link">isolate()</a></code> to prevent <code>renderText</code> from
being re-executed when <code>input$inputText</code> changes.</li>
</ol>
<p><code>isolate</code> is a function that prevents reactive values from
triggering recomputation of a reactive expression. It is very useful for
situations like this where you want output to be updated only when a
certain event occurs.</p>
<details><summary>
Solution 1
</summary><div class="sourceCode" id="section-cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textInput.html" class="external-link">textInput</a></span><span class="op">(</span><span class="st">"inputText"</span>, <span class="st">"Enter some text:"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html" class="external-link">actionButton</a></span><span class="op">(</span><span class="st">"goButton"</span>, <span class="st">"Go"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html" class="external-link">textOutput</a></span><span class="op">(</span><span class="st">"outputText"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">goButton</span>, <span class="op">{</span></span>
<span>        <span class="va">output</span><span class="op">$</span><span class="va">outputText</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="op">{</span></span>
<span>            <span class="co"># Note wrapping of input$inputText in isolate()</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"You entered:"</span>, <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/isolate.html" class="external-link">isolate</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">inputText</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span>ui <span class="op">=</span> <span class="va">ui</span>, server <span class="op">=</span> <span class="va">server</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><ol start="2" style="list-style-type: decimal">
<li>Get rid of the <code>observeEvent</code> and check the value of
<code>input$goButton</code> inside of <code>renderText</code>, again
coupled with <code>isolate</code>.</li>
</ol>
<details><summary>
Solution 2
</summary><div class="sourceCode" id="section-cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textInput.html" class="external-link">textInput</a></span><span class="op">(</span><span class="st">"inputText"</span>, <span class="st">"Enter some text:"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html" class="external-link">actionButton</a></span><span class="op">(</span><span class="st">"goButton"</span>, <span class="st">"Go"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html" class="external-link">textOutput</a></span><span class="op">(</span><span class="st">"outputText"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">output</span><span class="op">$</span><span class="va">outputText</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="co"># Action buttons have a counter that increments on click.</span></span>
<span>        <span class="co"># This will prevent the text from updating until the button is clicked.</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">goButton</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"You entered:"</span>, <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/isolate.html" class="external-link">isolate</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">inputText</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span>ui <span class="op">=</span> <span class="va">ui</span>, server <span class="op">=</span> <span class="va">server</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><p>The second solution is a more common pattern for using action buttons
than the first solution. It’s easier to follow and doesn’t require an
additional reactive expression in the form of the
<code>observeEvent</code> call.</p>
<p>The <code>isolate</code> function is used to prevent
<code>input$inputText</code> from triggering recomputation on its own,
so the text will only update when the button is clicked.</p>
<p>This example illustrates a common misunderstanding about Shiny’s
reactivity model, and also demonstrates the kind of thinking required to
debug a Shiny app. Debugging in Shiny can be challenging because the
code execution is event-driven and asynchronous, which is quite
different from the usual top-to-bottom flow of an R script.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="section-app-deployment">App Deployment<a class="anchor" aria-label="anchor" href="#section-app-deployment"></a>
</h2>
<p>After you’ve built your Shiny application, the next step is to share
it with the world. Or your lab/group. There are several ways to do this,
ranging from simple and free solutions for small apps, to more complex
and robust methods for large-scale applications.</p>
<p>In this section, we’ll cover two popular deployment options:
shinyapps.io and Posit (formerly RStudio) Connect.</p>
<div class="section level3">
<h3 id="section-shinyapps-io">Shinyapps.io<a class="anchor" aria-label="anchor" href="#section-shinyapps-io"></a>
</h3>
<p>Shinyapps.io is a service provided by RStudio for hosting Shiny
applications. It’s an easy way to publish your applications to the web
without needing to manage a server.</p>
<div class="section level4">
<h4 id="section-key-features">Key features:<a class="anchor" aria-label="anchor" href="#section-key-features"></a>
</h4>
<ul>
<li><p><strong>Simple Deployment:</strong> You can publish your apps
directly from your RStudio IDE with a few clicks.</p></li>
<li><p><strong>Scalability:</strong> Shinyapps.io can automatically
manage the server resources for your app, scaling it up and down as
needed based on traffic.</p></li>
<li><p><strong>Authentication and User Management:</strong> With
shinyapps.io, you can control who can access your applications. It also
supports Google Authentication and GitHub.</p></li>
<li><p><strong>Analytics:</strong> Shinyapps.io provides usage
statistics for your applications, so you can see how many people are
using it, when, and from where.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="section-limitations">Limitations:<a class="anchor" aria-label="anchor" href="#section-limitations"></a>
</h4>
<ul>
<li>The free tier of shinyapps.io has limitations on the number of
active hours your apps can have in a month, the number of applications
you can deploy, and the resources each can use (e.g. 4GB memory)
max.</li>
</ul>
<p>While shinyapps.io is great for small to medium-sized applications,
for large-scale enterprise applications, you might need more control
over your server environment.</p>
</div>
</div>
<div class="section level3">
<h3 id="section-posit-connect">Posit Connect<a class="anchor" aria-label="anchor" href="#section-posit-connect"></a>
</h3>
<p>Posit Connect is a more commerical, professional publishing platform.
It is designed to help you share Shiny applications, R Markdown reports,
Plumber APIs, data Pins, and more with your colleagues and
organization.</p>
<div class="section level4">
<h4 id="section-key-features-1">Key features:<a class="anchor" aria-label="anchor" href="#section-key-features-1"></a>
</h4>
<ul>
<li><p><strong>Flexible Deployment:</strong> You can deploy your apps on
your own servers, giving you more control over the environment.</p></li>
<li><p><strong>Security and Access Control:</strong> RStudio Connect
offers robust security features, including integration with many
enterprise authentication systems. You can control who can access your
applications at a very granular level.</p></li>
<li><p><strong>Schedule Reports:</strong> One of the most powerful
features of RStudio Connect is the ability to schedule R Markdown
reports and have them emailed to a list of recipients.</p></li>
<li><p><strong>Manage Multiple R Versions:</strong> RStudio Connect
supports multiple versions of R concurrently. This can be crucial for
reproducibility in team settings.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="section-limitations-1">Limitations:<a class="anchor" aria-label="anchor" href="#section-limitations-1"></a>
</h4>
<ul>
<li><p>RStudio Connect is a commercial product, and it comes with a
hefty cost. Fortunately, St. Jude has a liecense, so we don’t have to
worry about said cost.</p></li>
<li><p>Setting up RStudio Connect requires more technical expertise than
using shinyapps.io. You’ll need to install and manage it on your own
server. However, once it’s set up, it’s very easy to deploy applications
from RStudio. You can put in a serviceNow request to have a VM spun up
and Posit Connect installed on it.</p></li>
<li><p>Making apps publically available is a bit more complicated than
shinyapps.io, and St. Jude IT/legal has concerns if data is to be
uploaded to the server.</p></li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="section-handling-app-data">Handling App Data<a class="anchor" aria-label="anchor" href="#section-handling-app-data"></a>
</h3>
<p>When deploying a Shiny application, you can bundle data directly with
the app. This process involves including the data files in the same
directory as the app itself.</p>
<p>Here’s a general process for bundling data with a Shiny app:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Create a Data Folder:</strong> Within your Shiny app
project directory, create a separate folder (often named “data”) to
store your data files.</p></li>
<li><p><strong>Add Data Files:</strong> Copy your data files into this
folder. These files can be in any format that R can read, such as CSV,
RDS, or RData. It’s good practice to use relative paths when referencing
these data files in your app.</p></li>
<li><p><strong>Refer to Data Files:</strong> In your Shiny app code,
refer to these data files using relative paths. For example, if you have
a file named “mydata.csv” in a folder named “data”, you would load it in
R using something like read.csv(“./data/mydata.csv”).</p></li>
<li><p><strong>Deploy the App:</strong> When you deploy the app to
shinyapps.io or Shiny Connect, all files in the app’s directory,
including the data files, are bundled and deployed together.</p></li>
<li><p><strong>Access the Data:</strong> Once deployed, the Shiny app
can access the data files as if they were in the local environment
because they are part of the deployed app. However, remember that these
are read-only. If your app modifies the data, those modifications are
lost at the end of the session unless saved to a persistent storage
service like a database or cloud storage.</p></li>
</ol>
<p>This approach is great for smaller, static datasets. However, if you
have large datasets or if the data is updated frequently, it would be
better to store the data in a database or a cloud storage service, and
have the Shiny app read the data from there.</p>
</div>
<div class="section level3">
<h3 id="section-more-advanced-data-handling">More Advanced Data Handling<a class="anchor" aria-label="anchor" href="#section-more-advanced-data-handling"></a>
</h3>
<p>The topics below are beyond the scope of this workshop, but they are
useful to know about as you develop more complex Shiny applications.</p>
<div class="section level4">
<h4 id="section-sharing-and-re-using-data-with-the-pins-package">Sharing and Re-using Data with the <code>pins</code> Package<a class="anchor" aria-label="anchor" href="#section-sharing-and-re-using-data-with-the-pins-package"></a>
</h4>
<p>The <a href="https://pins.rstudio.com/" class="external-link">pins</a> package is a useful
tool for pinning, discovering, and sharing resources. It allows you to
cache large datasets on services like Posit Connect or cloud storage
services like AWS S3, Google Cloud Storage, Azure, Dropbox, or
SharePoint. This can be particularly useful for sharing large datasets
or analyses across multiple Shiny applications and keeping said data
in-sync.</p>
<p>It can also be used to simply keep important data objects organized
locally for your own use, or to share them easily with others.</p>
<p>For more information, you can read the <a href="https://pins.rstudio.com/articles/pins.html" class="external-link">Pins
vignettes</a>.</p>
</div>
<div class="section level4">
<h4 id="section-persistent-data-storage">Persistent Data Storage<a class="anchor" aria-label="anchor" href="#section-persistent-data-storage"></a>
</h4>
<p>For apps that require persistent data storage, there are several R
packages that can help. The <a href="https://db.rstudio.com/dbi/" class="external-link">DBI</a> package provides a common
interface to communicate with databases from R, and there are various
DBI-compliant packages for specific types of databases, like <a href="https://solutions.posit.co/connections/db/databases/my-sql/" class="external-link">MySQL</a>,
<a href="https://solutions.posit.co/connections/db/databases/sqlite/" class="external-link">RSQLite</a>,
and <a href="https://solutions.posit.co/connections/db/databases/postgresql/" class="external-link">RPostgres</a>.</p>
<p><a href="https://daattali.com/shiny/persistent-data-storage/" class="external-link">This
application</a> also shows multiple ways to deal with persistent data
storage in Shiny, along with code examples of each. <a href="https://shiny.posit.co/r/articles/build/persistent-data-storage/" class="external-link">The
associated article</a> provides more details.</p>
<p>For a tutorial on using databases with Shiny, see this guide from
RStudio.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="section-recap">Recap<a class="anchor" aria-label="anchor" href="#section-recap"></a>
</h2>
<p>To summarize, this module covered:</p>
<ul>
<li><p><strong>Common Gotchas and Debugging Challenges:</strong> We
discussed common “gotchas” for Shiny beginners, including issues with
asynchronous code, reactivity, and complex UIs. We also covered the
challenges of debugging Shiny apps.</p></li>
<li><p><strong>Debugging Shiny Apps:</strong> We introduced some useful
debugging tools like <code><a href="https://rdrr.io/r/base/browser.html" class="external-link">browser()</a></code> and <code><a href="https://rdrr.io/pkg/shiny/man/reactlog.html" class="external-link">reactlog()</a></code>,
and walked through a debugging example.</p></li>
<li><p><strong>App Deployment:</strong> We showed two ways to deploy
Shiny apps: shinyapps.io and Posit Connect, and discussed the pros and
cons of each. We also talked about how to bundle data with your Shiny
app and mentioned ways to more easily share data objects with
collaborators or multiple Shiny apps via the <code>pins</code>
package.</p></li>
</ul>
<p>By the end of this module, participants should have an idea of where
to start debugging their Shiny app and some of the unique challenges
that debugging in Shiny presents.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jared Andrews.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
